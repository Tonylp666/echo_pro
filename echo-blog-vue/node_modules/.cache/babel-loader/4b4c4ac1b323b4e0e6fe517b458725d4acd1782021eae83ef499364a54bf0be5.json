{"ast":null,"code":"import { defineStore } from 'pinia';\nimport { login, logout, getUserInfo } from '@/api/auth';\nimport { setToken, getToken, removeToken } from '@/utils/auth';\nexport const useUserStore = defineStore('user', {\n  state: () => ({\n    token: getToken(),\n    userInfo: null,\n    roles: []\n  }),\n  getters: {\n    isLoggedIn: state => !!state.token,\n    username: state => state.userInfo?.username || '',\n    name: state => state.userInfo?.name || '',\n    avatar: state => state.userInfo?.avatar || ''\n  },\n  actions: {\n    // 登录\n    async login(loginData) {\n      try {\n        const {\n          data\n        } = await login(loginData);\n        this.token = data.token;\n        setToken(data.token);\n        return Promise.resolve();\n      } catch (error) {\n        return Promise.reject(error);\n      }\n    },\n    // 获取用户信息\n    async getUserInfo() {\n      try {\n        const {\n          data\n        } = await getUserInfo();\n        this.userInfo = data;\n        this.roles = data.roles || [];\n        return Promise.resolve(data);\n      } catch (error) {\n        return Promise.reject(error);\n      }\n    },\n    // 登出\n    async logout() {\n      try {\n        await logout();\n        this.resetState();\n        return Promise.resolve();\n      } catch (error) {\n        return Promise.reject(error);\n      }\n    },\n    // 重置状态\n    resetState() {\n      this.token = '';\n      this.userInfo = null;\n      this.roles = [];\n      removeToken();\n    }\n  }\n});","map":{"version":3,"names":["defineStore","login","logout","getUserInfo","setToken","getToken","removeToken","useUserStore","state","token","userInfo","roles","getters","isLoggedIn","username","name","avatar","actions","loginData","data","Promise","resolve","error","reject","resetState"],"sources":["/Users/ls/echo_pro/echo-blog-vue/src/store/user.js"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { login, logout, getUserInfo } from '@/api/auth'\nimport { setToken, getToken, removeToken } from '@/utils/auth'\n\nexport const useUserStore = defineStore('user', {\n  state: () => ({\n    token: getToken(),\n    userInfo: null,\n    roles: []\n  }),\n  \n  getters: {\n    isLoggedIn: (state) => !!state.token,\n    username: (state) => state.userInfo?.username || '',\n    name: (state) => state.userInfo?.name || '',\n    avatar: (state) => state.userInfo?.avatar || ''\n  },\n  \n  actions: {\n    // 登录\n    async login(loginData) {\n      try {\n        const { data } = await login(loginData)\n        this.token = data.token\n        setToken(data.token)\n        return Promise.resolve()\n      } catch (error) {\n        return Promise.reject(error)\n      }\n    },\n    \n    // 获取用户信息\n    async getUserInfo() {\n      try {\n        const { data } = await getUserInfo()\n        this.userInfo = data\n        this.roles = data.roles || []\n        return Promise.resolve(data)\n      } catch (error) {\n        return Promise.reject(error)\n      }\n    },\n    \n    // 登出\n    async logout() {\n      try {\n        await logout()\n        this.resetState()\n        return Promise.resolve()\n      } catch (error) {\n        return Promise.reject(error)\n      }\n    },\n    \n    // 重置状态\n    resetState() {\n      this.token = ''\n      this.userInfo = null\n      this.roles = []\n      removeToken()\n    }\n  }\n}) "],"mappings":"AAAA,SAASA,WAAW,QAAQ,OAAO;AACnC,SAASC,KAAK,EAAEC,MAAM,EAAEC,WAAW,QAAQ,YAAY;AACvD,SAASC,QAAQ,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,cAAc;AAE9D,OAAO,MAAMC,YAAY,GAAGP,WAAW,CAAC,MAAM,EAAE;EAC9CQ,KAAK,EAAEA,CAAA,MAAO;IACZC,KAAK,EAAEJ,QAAQ,CAAC,CAAC;IACjBK,QAAQ,EAAE,IAAI;IACdC,KAAK,EAAE;EACT,CAAC,CAAC;EAEFC,OAAO,EAAE;IACPC,UAAU,EAAGL,KAAK,IAAK,CAAC,CAACA,KAAK,CAACC,KAAK;IACpCK,QAAQ,EAAGN,KAAK,IAAKA,KAAK,CAACE,QAAQ,EAAEI,QAAQ,IAAI,EAAE;IACnDC,IAAI,EAAGP,KAAK,IAAKA,KAAK,CAACE,QAAQ,EAAEK,IAAI,IAAI,EAAE;IAC3CC,MAAM,EAAGR,KAAK,IAAKA,KAAK,CAACE,QAAQ,EAAEM,MAAM,IAAI;EAC/C,CAAC;EAEDC,OAAO,EAAE;IACP;IACA,MAAMhB,KAAKA,CAACiB,SAAS,EAAE;MACrB,IAAI;QACF,MAAM;UAAEC;QAAK,CAAC,GAAG,MAAMlB,KAAK,CAACiB,SAAS,CAAC;QACvC,IAAI,CAACT,KAAK,GAAGU,IAAI,CAACV,KAAK;QACvBL,QAAQ,CAACe,IAAI,CAACV,KAAK,CAAC;QACpB,OAAOW,OAAO,CAACC,OAAO,CAAC,CAAC;MAC1B,CAAC,CAAC,OAAOC,KAAK,EAAE;QACd,OAAOF,OAAO,CAACG,MAAM,CAACD,KAAK,CAAC;MAC9B;IACF,CAAC;IAED;IACA,MAAMnB,WAAWA,CAAA,EAAG;MAClB,IAAI;QACF,MAAM;UAAEgB;QAAK,CAAC,GAAG,MAAMhB,WAAW,CAAC,CAAC;QACpC,IAAI,CAACO,QAAQ,GAAGS,IAAI;QACpB,IAAI,CAACR,KAAK,GAAGQ,IAAI,CAACR,KAAK,IAAI,EAAE;QAC7B,OAAOS,OAAO,CAACC,OAAO,CAACF,IAAI,CAAC;MAC9B,CAAC,CAAC,OAAOG,KAAK,EAAE;QACd,OAAOF,OAAO,CAACG,MAAM,CAACD,KAAK,CAAC;MAC9B;IACF,CAAC;IAED;IACA,MAAMpB,MAAMA,CAAA,EAAG;MACb,IAAI;QACF,MAAMA,MAAM,CAAC,CAAC;QACd,IAAI,CAACsB,UAAU,CAAC,CAAC;QACjB,OAAOJ,OAAO,CAACC,OAAO,CAAC,CAAC;MAC1B,CAAC,CAAC,OAAOC,KAAK,EAAE;QACd,OAAOF,OAAO,CAACG,MAAM,CAACD,KAAK,CAAC;MAC9B;IACF,CAAC;IAED;IACAE,UAAUA,CAAA,EAAG;MACX,IAAI,CAACf,KAAK,GAAG,EAAE;MACf,IAAI,CAACC,QAAQ,GAAG,IAAI;MACpB,IAAI,CAACC,KAAK,GAAG,EAAE;MACfL,WAAW,CAAC,CAAC;IACf;EACF;AACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}